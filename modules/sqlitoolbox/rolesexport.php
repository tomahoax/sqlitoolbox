<?php//@TODO Permettre la sÃ©lection de la colonne et du sens du tri depuis le BO$errormsg = '';$logList = array();$tpl = eZTemplate::factory();$Module = $Params["Module"];$http = eZHTTPTool::instance();if ($http->hasPostVariable('ExportIDArray')){    $roleFilter = $http->postVariable('ExportIDArray');    $allRolesList = eZRole::fetchList();    $rolesList = array();        $optList = array();    foreach ($allRolesList as $role )    {    	if(in_array($role->ID,$roleFilter))    	{    		array_push($rolesList,$role);    	}		        $optList[$role->attribute('identifier')] = array();    }    $tpl->setVariable( 'rolesList', $rolesList );    $tpl->setVariable( 'opt_list', $optList );    //$tpl->setVariable( "class_count", count( $roles ) );    $result = $tpl->fetch( 'design:sqlitoolbox/xml/rolesexport.tpl' );    echo $result;    eZExecution::cleanup();    eZExecution::setCleanExit();    header('Content-Type: text/xml');    header('Content-Disposition: attachment;');    header('Pragma: no-cache' );    header('Expires: 0' );    exit(0);}$rolesList = eZRole::fetchList();$objectCounts = array();foreach ($rolesList as $roleElement){    $roleID = $roleElement->attribute('id');    $objectCounts[$roleID] = eZContentObject::fetchSameClassListCount($roleID);}$page_uri = $Module->redirectionURI( 'sqlitoolbox', 'rolesexport');$tpl->setVariable('page_uri', $page_uri );$tpl->setVariable( 'rolesList', $rolesList );$tpl->setVariable( 'objectCounts', $objectCounts );$Result['left_menu'] = 'design:sqlitoolbox/parts/leftmenu.tpl';$Result['content'] = $tpl->fetch( 'design:sqlitoolbox/rolesexport.tpl' );